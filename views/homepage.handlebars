<div class="col align-center mb-10">
  {{#if logged_in}}
  <div id="butts" style="display: flex; ">
    <button class="btn" style="margin: 10px; color:white" onclick="newpost()">NewPost</button>
  </div>
  {{!-- style="display:flex; flex-flow: column wrap" --}}
<div id="NewPosts" style="display: none;">
  <div id="postinput" class="col-md-8">
    <div style="display:flex; flex-flow: row wrap; ">
      <h5 style: 'margin: 0 10px 0 0'>Post Title: </h5>
      <textarea name="title" id="title" cols="30" rows="1"></textarea>
    </div>
    <div style="display:flex; flex-flow: row wrap; ">
        <h5 style: 'margin: 0 10px 0 0'>Blog Content : </h5>
        <textarea rows="4" cols="50" id="content" name="content" form="blogposting"></textarea>
        <button id="submitPost" onclick= 'subPost({{logininfo.id}})'>SubmitPost</button>
     </div>
  </div>
</div>
{{/if}}
{{!-- <h2>{{user_name}} <span> {{user_id}} </span> Logged In</h2> --}}
<div class="col-md-8">
  {{#each blogs as |blog| }}
  {{> blog-details blog=blog}}
  {{/each}}
</div>
</div>
<script>
  function newpost() {
    document.getElementById('NewPosts').style.display = "block";
    document.getElementById('butts').style.display = "none";
}

async function subPost(create){
  const title = document.querySelector('#title').value.trim();
  const content = document.querySelector('#content').value.trim();
  const creator = create;
  
  if (content && title ) {
    const response = await fetch('/api/blogposts', {
      method: 'POST',
      body: JSON.stringify({ title,content,creator}),
      headers: { 'Content-Type': 'application/json' },
    });

    if (response.ok) {
      document.location.replace('/');
    } else {
      alert('Failed to post.');
    }
   }
  };
</script>